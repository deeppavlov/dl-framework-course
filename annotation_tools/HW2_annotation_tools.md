# Домашнее задание 2. Инструменты для аннотации и визуализации данных. 

## Задание 1. Анализ диалогов с Gradio

### Данные: [Movie Dialog Corpus](https://www.kaggle.com/datasets/Cornell-University/movie-dialog-corpus)
### Задачи: 

1. Работа с данными - 1 балл 

Корпус представляет собой несколько таблиц с данными о последовательсти реплик в диалогах, названиях фильмов и т.д. Для выполнения следующих задач вам необходимо объединить таблицы в одну с помощью pandas. В таблице должна быть представлена следующая информация: диалог (список реплик), спикеры (список), фильм, из которого взят диалог, жанры фильма.

2. Sentiment - 9 баллов
Для этого задания нужно вспомнить, что рассматривалось на лекции про Ray Serve: [XGBoosst](https://github.com/deeppavlov/dl-frameworks-course/blob/dev/Pytorch_MLOps/Ray_serve_xgboost.ipynb)
и [NLP](https://github.com/deeppavlov/dl-frameworks-course/blob/dev/Pytorch_MLOps/Ray_Serve_NLP.ipynb).

Необходимо также взять модель c huggingface, которая классифицирует предложения по тональности.

Нужно реализовать следующие пункты: 

- написать простое API для модели и задеплоить с Ray Serve. Попробуйте адаптировать API для разных типов входных данных: простой текст, датафрейм и батчи
- портировать реализованное API на FastAPI: 
  - предусмотрите валидацию входных данных с помощью pydantic.
  - добавьте дополнительные параметры, например максимальное кол-во реплик для классификации, длина реплики и пр. Пофантазируйте.
- реализовать интерфейс. На вход мы подаем в интерфейс диалог, но классифицируется каждая реплика, затем необходимо посчитать соотношение positive/negative/neutral 
для каждого говорящего и визуализировать это. Адаптируйте этот интерфейс для запуска на кластере Ray [Дока] (https://docs.ray.io/en/latest/serve/tutorials/gradio-integration.html)

Input: диалог
Output: график или диаграмма, который отражает соотношения классов сентимента для каждого говорящего.

3. Genre + Emotions - 6 баллов

- Взять классификатор эмоций с huggingface и разметить диалоги из датасета. Если это занимает очень много времени, то можно взять 40-50 диалогов, у которых длина поменьше. 
- Найти в датасете информацию о жанре фильмов, из которых были взяты диалоги, и информацию о поле говорящего.
- Необходимо сделать визуализацию для анализа распределения эмоций в диалогах в зависимости от жанра фильма с помощью gradio. Визуализация должна представлять интерфейс, в котором
можно выбрать определенный жанр или несколько. 
Input: "horror" (это должны быть кнопки)
Output: статистика по эмоциям (можно в виде графика, можно и просто в текстовом формате)
4. Дополнительные баллы:

- Если ваш интерфейс может учитывать случаи перечений жанров - 2 балла
- Красивая визуализация - 2 балла
Советую заглянуть в [документацию gradio](https://gradio.app/guides/). Там можно найти много примеров подключения моделей и реализации различных кнопок.
Это задание сдается в Colab-е.


## Задание 2. Streamlit
Во втором задании мы работаем с тем же датасетом, однако реализуем интерфейсы с помощью Streamlit.
### Данные: [Movie Dialog Corpus](https://www.kaggle.com/datasets/Cornell-University/movie-dialog-corpus)

## Задачи: 
1.Speaker + Emotions - 4 баллов
- Создать интерфейс, в котором можно выбирать следующие параметры: название фильма, спикер. 
- Если выбирается только название фильма, значит output - статистика по эмоциям персонажей в этом фильме.
- Если выбирается фильм, а потом определенный персонаж, тогда выдается статистика по эмоциям персонажа. 
2. Интерфейс для аннотации - 6 баллов
- Создать интерфейс для аннотации реплик из диалогов на эмоции. Аннотатору необходимо давать предыдущую и текущую реплики и просить выбрать одну или несколько эмоций,
которые бы могли характеризовать эту реплику.
- Эмоции должны выбираться аннотатором с помощью кнопок.
- Аннотатор должен иметь возможность выбрать фильм, диалоги из которого он хочет размечать.
Оба задания необходимо выложить в [spaces](https://huggingface.co/spaces). 

Сдавать задания нужно в [эту форму](https://forms.gle/u9XFb2FC2HWJAiMf9).
